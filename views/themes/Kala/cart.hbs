<div class="row">
  <div class="col-xs-12 col s12">
    {{#if pageCloseBtn}}
    <div class="row {{checkout}}">
      <div class="col-lg-12 col l12 text-right">
        <button class="pushy-link btn btn-primary" type="button">X</button>
      </div>
    </div>
    {{/if}}
    <div class="panel panel-default" style="margin-top: 30px;">
      <div class="panel-heading">{{ @root.__ "Cart contents" }}</div>
      <div class="panel-body cart-body">
        <div class="container-fluid">
          {{#each @root.session.cart}}
          <div class="row cart-row">
            <div class="col-md-3 no-pad-left no-pad-right">
              {{#if productImage}}
              <img class="img-responsive" src="{{this.productImage}}" alt="{{this.title}} product image">
              {{else}}
              <img class="img-responsive" src="/uploads/placeholder.png" alt="{{this.title}} product image"> 
              {{/if}}
            </div>
            <div class="col-md-6 cart-item-row text-left">
              <p>
                <a class="cart-link" href="/product/{{this.link}}">{{this.title}}</a>
              </p>
              {{#if this.options}}
                <p>&nbsp;
                  {{#each options}}
                    {{#if @last}} 
                      {{@key}}: {{this}} 
                    {{else}} 
                      {{@key}}: {{this}} / 
                    {{/if}}
                  {{/each}}
                </p>
              {{/if}}
              <p>
                <div class="form-group">
                  <div class="col-md-12 no-pad-left">
                    {{#if this.uniqueProduct}}
                      <strong><i class="fa fa-star-o"></i> {{ @root.__ "This product is a unique piece" }}</strong>
                      <span class="pull-right">
                        <div class="delete-item btn-delete-from-cart" data-id="{{this.productId}}" type="button"><i class="fa fa-trash" data-id="{{this.productId}}" aria-hidden="true"></i></div>
                      </span>
                    {{else}}
                    <div class="input-group">
                      <span class="input-group-btn">
                        <button class="btn btn-sm btn-primary btn-qty-minus" type="button">-</button>
                      </span>
                      <input type="number" class="form-control cart-product-quantity input-sm text-center" data-id="{{this.productId}}" id="{{@key}}"
                        maxlength="2" value="{{this.quantity}}">
                      <span class="input-group-btn">
                        <button class="btn btn-sm btn-primary btn-qty-add" type="button">+</button>
                      </span>
                      {{!-- moved from grandparent --}}
                      <span class="pull-right">
                        <button class="btn btn-sm btn-danger btn-delete-from-cart" data-id="{{this.productId}}" type="button"><i class="fa fa-trash" data-id="{{this.productId}}" aria-hidden="true"></i></button>
                      </span>
                    </div>
                    {{/if}}
                  </div>
                </div>
              </p>
            </div>
            <div class="col-md-3 cart-item-row text-right no-pad-right">
              <strong>{{currencySymbol ../config.currencySymbol}}{{formatAmount this.totalItemPrice}}</strong><br>
              {{#ifCond productDiscount '>' 0}}
                <strong class="before">-{{../productDiscount}}%</strong><br>
                <strong>{{currencySymbol ../config.currencySymbol}}{{opCalc ../totalItemPrice '%' ../productDiscount}}</strong>
              {{/ifCond}}
            </div>
          </div>
          {{/each}}
        </div>
        <div class="container-fluid">
          {{#if @root.session.cart}}
          <div class="row">
            <div class="cart-contents-shipping col-md-12 col m12 no-pad-right">
              {{#ifCond @root.session.shippingCostApplied '===' true}}
              <div class="text-right">
                {{ @root.__ "Shipping" }}
                <strong>{{currencySymbol @root.config.currencySymbol}}{{formatAmount @root.config.flatShipping}}</strong>
              </div>
              {{else}}
              <div class="text-right">
                {{ @root.__ "Shipping" }}
                <strong>FREE</strong>
              </div>
              {{/ifCond}}
              <div class="text-right">
                Total:
                <strong>{{currencySymbol @root.config.currencySymbol}}{{formatAmount @root.session.totalCartAmount}}</strong>
              </div>
            </div>
          </div>
          {{else}}
          <div class="row">
            <div class="cart-contents-shipping col-md-12 no-pad-right">
              Cart empty
            </div>
          </div>
          {{/if}}
        </div>
      </div>
    </div>
    {{#ifCond page '==' 'pay'}}
    <div class="panel panel-default" style="margin-top: 30px;">
      <div class="panel-heading">{{ @root.__ "Choose payment mode" }}</div>
      <div class="panel-body">
        {{#if @root.session.cart}}
        <div class="row">
          <div class="col-md-4 no-pad-right">
            <div class="payment-type" data-delayed="" data-id="">
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="card" checked>
                </div>
                <div class="title">{{ @root.__ "Credit card" }}</div><br>
                <div class="img-holder"><img src="/images/v_card.png" alt="Tarjeta bancaria"></div>
            </div>
          </div>
          <div class="col-md-4 no-pad-right">
            <div class="payment-type">
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="paypal">
                </div>
                <div class="title">{{ @root.__ "PayPal" }}</div><br>
                <div class="img-holder"><img src="/images/v_paypal.png" alt="PayPal"></div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 no-pad-right">
            <div class="payment-details" data-type="card" data-id="">
                <hr>
                <div class="description">{{ @root.__ "Insert credit card details" }}</div>
                <div class="cc-box">
                  <div class="cc-item">
                    <label for="cc-number" class="cc-label">{{ @root.__ "Credit card number" }}</label>
                    <input type="text" class="form-control cc-number" placeholder="1234 1234 1234 1234 1234" name="">
                  </div>
                  <div class="cc-item">
                    <label for="cc-expires" class="cc-label">{{ @root.__ "Expire date" }}</label>
                    <input type="text" class="form-control cc-expires" name="" placeholder="MM / YYYY"></div>
                  <div class="cc-item">
                    <label for="cc-cvc" class="cc-label">{{ @root.__ "Cvc" }}</label>
                    <input type="text" class="form-control cc-cvc" placeholder="123" name=""></div>
                  <div class="cc-item">
                    <button type="" class="btn btn-success form-control cc-send" name="Send">{{ @root.__ "Pay" }}</div>
                </div>
            </div>
            <div class="payment-details" data-type="paypal" id="checkout_paypal" >
                <hr>
                <div class="description">
                  {{{ @root.__ "redirection_html" }}}
                </div>
                <div class="payment-action" id="checkout_paypal">
                  <div class="title">{{ @root.__ "Pay with" }}</div>
                  <div class="img-holder"><img src="/images/v_paypal.png" alt="PayPal"></div>
                </div>
            </div>
          </div>
        </div>
        {{/if}}
      </div>
    </div>
    {{/ifCond}}
    <div class="row">
      {{#if @root.session.cart}}
        {{#ifCond page '!=' 'pay'}}
        <div class="col-xs-6 col s6 text-left align-right">
          <button class="btn empty-cart" id="empty-cart" type="button">{{ @root.__ "Empty cart" }}</button>
        </div>
        <div class="text-right align-right col-xs-6 col s6">
          {{#ifCond @root.page '==' 'checkout'}}
          <a href="/pay" class="btn btn-default">{{ @root.__ "Pay now" }}</a>
          {{else}}
          <a href="/checkout" class="btn btn-default">{{ @root.__ "Checkout" }}</a>
          {{/ifCond}}
        </div>
        {{/ifCond}}
        {{!-- 
        {{#ifCond page '==' 'pay'}}
          {{#if @root.session.customer}}
            {{#ifCond @root.config.paymentGateway '==' 'paypal'}}
                {{> partials/payments/paypal}}
            {{/ifCond}}
          {{/if}}
        {{/ifCond}}
        --}}
      {{/if}}
    </div>
  </div>
</div>
